# Generated by roxytest: do not edit by hand!

# File R/cls_record_fam.R: @tests

test_that("Function FamilyRecord() @ L40", {
  fct <- list(FamilyEvent("MARR", husb_age = "22y", wife_age = "28y 6m",
                             date = "22 AUG 1907", place = "Church"))
  nevent <- list(NonEvent("DIV"))
  expect_snapshot_value(FamilyRecord(XREF = "@F2@",
                                         facts = fct, non_events = nevent,
                                         husb_xref = "@I8@", wife_xref = "@I9@",
                                         chil_xrefs = c("@I98@", Eldest = "@I67@"),
                                         locked = TRUE,
                                         citations = c("@S34@","@S65@"))@GEDCOM, "json2")
  expect_error(FamilyRecord("REF"), regexp = "@XREF is in an invalid format")
  expect_error(FamilyRecord(unique_ids = letters), regexp = "@unique_ids is in an invalid format")
  expect_error(FamilyRecord(ext_ids = LETTERS), regexp = "@ext_ids has too few elements")
  expect_snapshot_value(FamilyRecord("@1@",
                                     unique_ids = "a95b5007-2ad2-4bac-81b0-7184243c4512",
                                     ext_ids = stats::setNames(letters, LETTERS)[1:5],
                                     user_ids = month.abb[1:6])@GEDCOM_IDENTIFIERS, "json2")
  expect_equal(FamilyRecord(facts = FamilyAttribute("NCHI", 3),
                            chil_xrefs = c("@1@","@2@"))@NUM_CHILDREN, 3)
  expect_equal(FamilyRecord(facts = FamilyAttribute("NCHI", 2),
                            chil_xrefs = c("@1@","@2@","@3@"))@NUM_CHILDREN, 3)
})

